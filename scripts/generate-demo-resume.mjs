/**
 * Generate a placeholder resume PDF at public/resume.pdf
 * Usage: node scripts/generate-demo-resume.mjs
 */

import { PDFDocument, StandardFonts, rgb } from "pdf-lib";
import { writeFileSync, mkdirSync } from "fs";
import { dirname, join } from "path";
import { fileURLToPath } from "url";

const __dirname = dirname(fileURLToPath(import.meta.url));
const outPath = join(__dirname, "..", "public", "resume.pdf");

async function main() {
  const doc = await PDFDocument.create();
  const page = doc.addPage([595.28, 841.89]); // A4
  const { width, height } = page.getSize();

  const bold = await doc.embedFont(StandardFonts.HelveticaBold);
  const regular = await doc.embedFont(StandardFonts.Helvetica);

  const dark = rgb(0.04, 0.05, 0.06);
  const gray = rgb(0.42, 0.44, 0.48);
  const accent = rgb(1, 0.8, 0.2);

  // Header
  page.drawText("Naman Kumar", {
    x: 50,
    y: height - 80,
    size: 28,
    font: bold,
    color: dark,
  });

  page.drawText("SRE & Cloud Engineering Leader  ·  Melbourne, VIC", {
    x: 50,
    y: height - 110,
    size: 12,
    font: regular,
    color: gray,
  });

  // Accent line
  page.drawRectangle({
    x: 50,
    y: height - 130,
    width: width - 100,
    height: 2,
    color: accent,
  });

  // Placeholder body
  const lines = [
    "Resume Placeholder",
    "",
    "This is a demo PDF generated by the portfolio site build system.",
    "Replace this file with your actual resume.",
    "",
    "To regenerate this placeholder:",
    "  npm run gen:resume",
    "",
    "Contact:",
    "  Email: namankumar2397@gmail.com",
    "  Phone: +61 452 176 778",
    "  LinkedIn: https://www.linkedin.com/in/-namankumar/",
  ];

  let y = height - 170;
  for (const line of lines) {
    const isHeading = line === "Resume Placeholder";
    page.drawText(line, {
      x: 50,
      y,
      size: isHeading ? 18 : 11,
      font: isHeading ? bold : regular,
      color: isHeading ? dark : gray,
    });
    y -= isHeading ? 28 : 18;
  }

  const bytes = await doc.save();
  mkdirSync(dirname(outPath), { recursive: true });
  writeFileSync(outPath, bytes);
  console.log(`✓ Demo resume written to ${outPath}`);
}

main().catch((err) => {
  console.error(err);
  process.exit(1);
});
